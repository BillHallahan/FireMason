
==================== FINAL INTERFACE ====================
2016-09-16 15:15:51.168912 UTC

interface main@main:InstructionsToIptables 7103
  interface hash: f7f84568ec3ce8773b35bca89a9e9740
  ABI hash: 029ad424c8a6faadeec6da4079eee48a
  export-list hash: 02a97126ef86110d12944799c75427b4
  orphan hash: 693e9af84d3dfcc71e640e005bdc5e2e
  flag hash: e468f87777beb3fe7114763efe9ccb2f
  sig of: Nothing
  used TH splices: False
  where
exports:
  InstructionsToIptables.addToIptables
  InstructionsToIptables.commentOutRules
module dependencies: ConvertIptables ConvertIptablesLimits
                     ConvertIptablesPorts IptablesTypes NameIdChain ParserHelp Types
package dependencies: MissingH-1.3.0.2@Missi_JQoKIaJuITOBZjt8xhTikH
                      appar-0.1.4@appar_0ov5bpGH3STIB4U7WU8MFi
                      array-0.5.1.0@array_67iodizgJQIIxYVTp4emlA base-4.8.2.0
                      binary-0.7.5.0@binar_3uXFWMoAGBg0xKP9MHKRwi
                      byteorder-1.0.4@byteo_6yQGE3rJo3bBqr3CFoBQ27
                      bytestring-0.10.6.0@bytes_6VWy06pWzJq9evDvK2d4w6
                      case-insensitive-1.2.0.7@casei_2hQWsf0VfQP5NW180eleos
                      containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU
                      deepseq-1.4.1.1@deeps_6vMKxt5sPFR0XsbRWvvq59 ghc-prim-0.4.0.0
                      hashable-1.2.4.0@hasha_EalUWgp8NarBYWPbvYAD8I integer-gmp-1.0.0.0
                      iproute-1.7.0@iprou_EmwGKuwHXxo93hguRyGitY
                      largeword-1.2.5@large_7BOdRtoTTTgFdsG28EDk6P
                      mtl-2.2.1@mtl_Aue4leSeVkpKLsfHIV51E8
                      network-2.6.3.1@netwo_4FL8hbDqfKm3Q9HV1QK1xw
                      regex-base-0.93.2@regex_47KXx9dLqeO8MNJeizLKhP
                      regex-posix-0.95.2@regex_ClFHQvfj6rtJ1Pxo4OAy89
                      regex-compat-0.95.1@regex_EyUO1k1s8YNJ81jSdgVW1z
                      semigroups-0.18.1@semig_LaeT7FLzCl4KIQUoVrPYl1
                      split-0.2.3.1@split_2IxbOPGrTSq7kFrJA7odmE
                      tagged-0.8.4@tagge_LPeicl3HxVfGUMMwMEsAE6
                      text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne
                      tostring-0.2.1.1@tostr_3WKXD89KZfc5BSX8Q5dXep
                      transformers-0.4.2.0@trans_GZTjP9K5WFq01xC9BAGQpF
                      unordered-containers-0.2.7.1@unord_5iWC5HdL16JGHXLbsgBJnw
                      utf8-string-1.0.1.1@utf8s_L8eKHa7Iv9q7FVKUYW6u4b
orphans: base-4.8.2.0:GHC.Base base-4.8.2.0:GHC.Float
         binary-0.7.5.0@binar_3uXFWMoAGBg0xKP9MHKRwi:Data.Binary.Generic
         bytestring-0.10.6.0@bytes_6VWy06pWzJq9evDvK2d4w6:Data.ByteString.Builder
         hashable-1.2.4.0@hasha_EalUWgp8NarBYWPbvYAD8I:Data.Hashable.Generic
         main@main:Types
         network-2.6.3.1@netwo_4FL8hbDqfKm3Q9HV1QK1xw:Network.Socket
         regex-base-0.93.2@regex_47KXx9dLqeO8MNJeizLKhP:Text.Regex.Base.Context
         regex-posix-0.95.2@regex_ClFHQvfj6rtJ1Pxo4OAy89:Text.Regex.Posix.ByteString
         regex-posix-0.95.2@regex_ClFHQvfj6rtJ1Pxo4OAy89:Text.Regex.Posix.ByteString.Lazy
         regex-posix-0.95.2@regex_ClFHQvfj6rtJ1Pxo4OAy89:Text.Regex.Posix.Sequence
         regex-posix-0.95.2@regex_ClFHQvfj6rtJ1Pxo4OAy89:Text.Regex.Posix.String
         text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne:Data.Text
         text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne:Data.Text.Lazy
         text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne:Data.Text.Show
         transformers-0.4.2.0@trans_GZTjP9K5WFq01xC9BAGQpF:Control.Monad.Trans.Error
family instance modules: base-4.8.2.0:Control.Applicative
                         base-4.8.2.0:Data.Either base-4.8.2.0:Data.Functor.Identity
                         base-4.8.2.0:Data.Monoid base-4.8.2.0:Data.Type.Equality
                         base-4.8.2.0:Data.Void base-4.8.2.0:GHC.Exts
                         base-4.8.2.0:GHC.Generics
                         containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.IntMap.Base
                         containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.IntSet.Base
                         containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.Map.Base
                         containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.Sequence
                         containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.Set.Base
                         iproute-1.7.0@iprou_EmwGKuwHXxo93hguRyGitY:Data.IP.Addr
                         iproute-1.7.0@iprou_EmwGKuwHXxo93hguRyGitY:Data.IP.Range
                         semigroups-0.18.1@semig_LaeT7FLzCl4KIQUoVrPYl1:Data.List.NonEmpty
                         semigroups-0.18.1@semig_LaeT7FLzCl4KIQUoVrPYl1:Data.Semigroup
                         tagged-0.8.4@tagge_LPeicl3HxVfGUMMwMEsAE6:Data.Tagged
                         text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne:Data.Text
                         text-1.2.2.1@text_HmqVQnZSpjaC156ABqPhne:Data.Text.Lazy
                         unordered-containers-0.2.7.1@unord_5iWC5HdL16JGHXLbsgBJnw:Data.HashMap.Base
                         unordered-containers-0.2.7.1@unord_5iWC5HdL16JGHXLbsgBJnw:Data.HashSet
import  -/  base-4.8.2.0:Data.Either e8724afd65fd432cfe9a54014f5f762d
import  -/  base-4.8.2.0:Data.Foldable 2ce969969ad5231eb40bd713f94f05ad
import  -/  base-4.8.2.0:Data.List 3f0782c8d4bf50eecefcd5ea1798aac8
import  -/  base-4.8.2.0:Data.Maybe 1cb58de2b04ee3c0c0a7dc9201184aff
import  -/  base-4.8.2.0:Data.OldList d8fd80b0e14aa085ce6219cd89dad356
import  -/  base-4.8.2.0:Debug.Trace 6660afb6094d69397ea084364da8f950
import  -/  base-4.8.2.0:GHC.Base 1db77db5dae73d8c424c85b09fbadb89
import  -/  base-4.8.2.0:GHC.List 0c736920522bbd14b770342776012ab6
import  -/  base-4.8.2.0:GHC.Num 9f42750c866f5832ca565146bd660c60
import  -/  base-4.8.2.0:GHC.Show 0e1d8380a8fb0cfb07ebeda3b70cbf38
import  -/  base-4.8.2.0:Prelude 694dcaf039efe62df1c44834e2dbd2fb
import  -/  containers-0.5.6.2@conta_2C3ZI8RgPO2LBMidXKTvIU:Data.Map bf7758bd12b23a367777a33fd16e39de
import  -/  ghc-prim-0.4.0.0:GHC.Classes e1f4ff80f7b5262008a595d29986fb18
import  -/  ConvertIptables e97e7276ee56f4020b273ac1792aa478
  exports: 2ab3ec9c0a3c253fc0e6263fd3ae77d5
  convertScript' b01316f7026fac7219bc3e0acfbc7e5d
import  -/  IptablesTypes a8bddafcdf14ff361369377deca32a6c
  exports: d7e48047831db0f2703ffd9b6a21af17
  Append 741853c63cb0e92ef0b0777e9fe96d9e
  Command 4e2ae75ee3b477dcd91b4d0d5a242abc
  Insert be7385e63bc1d393a4921ba222091991
  comChainName 2dd0bdd7fbf7cc3af6e6037889129d81
  command 4fedd3f46be0758540256065226477e5
  fileline d7f65c7ce523b1dd98959f7fcddc15f6
import  -/  NameIdChain 82de17877c1a2ba2bc457b2b4344ab82
  exports: 1404acfb85a934eafad2eb4c785471d5
  IdNameChain 236fcdd68ade61509ed973d26be27184
  lookupName 120ce4f59a9d4be96044c1647889d652
import  -/  ParserHelp c7affdab4be2cddd08133e07d05d3b63
  exports: 4408f0f73d248a4701f2f315f854c188
import  -/  Types ae53e2699ad6d0166c06d9687149e3e7
  exports: d51b92dffa880c4df17ac8601327b0a2
  ACCEPT 08ea8d5ba9c8e5ae84bd818c2cc3ee1f
  BoolFlag 8e31b955518611cb68524179997dad2b
  Criteria e19364fbcccdcd240635a00eaccbd95c
  DROP e0e88d7e035c9851606c6a03aeae2391
  Destination 922d80ba258cc0a086584d38ca75ebef
  Go 4c5408c41de596e0dc952fb3fcb57393
  IPAddress 9f35cd54f77f8e8e6e4d3e183b9dc3a8
  Not 1adbafabbd7f98320f67479286fd3b91
  Port 175675c7c9254add9716442f319e60d5
  Protocol 28d217f7cfd42059fccbb1335d04e6b8
  Rule 30c487073b35ac8fdff0d361e2257c83
  Rule 2763a04da1bec065877eb2b8e3c9f38c
  Source b53eb4518fedc84d30c0b4327bd32c7d
  Target 97fc31d3ca68602965fcc27b6e7cac76
  flagsToStrings 43d8dcd97bd58f3a2f261031dcde0a32
  ifNotRemoveNot a5e444c12487d1077f3ad3729abe9549
  isNot 7716d4c3e98a0f60d908a97047fd83af
  stringsToFlags 7126d0f2a863ad1a2511873cf82249d1
aed9d7cf16fcf8075a1b8a479104e576
  $fToIptablesCommand ::
    InstructionsToIptables.ToIptables IptablesTypes.Command
  DFunId[0]
  {- Arity: 2, Strictness: <S,1*U><L,A>, Inline: INLINE (sat-args=0),
     Unfolding: InlineRule (0, False, True)
                InstructionsToIptables.$fToIptablesCommand_$cconvert
                  `cast`
                (Sym (InstructionsToIptables.NTCo:ToIptables[0]
                          <IptablesTypes.Command>_N)) -}
47773ada148e997b57a6770b64974ca3
  $fToIptablesCommand1 :: GHC.Base.String
  {- Strictness: b -}
c67cf9bb3618322c20a1c9f7cde7bd7d
  $fToIptablesCommand_$cconvert ::
    IptablesTypes.Command -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 2, Strictness: <S,1*U><L,A>, Inline: INLINE[0],
     Unfolding: InlineRule (2, True, True)
                (\ w :: IptablesTypes.Command w1 :: NameIdChain.IdNameChain ->
                 InstructionsToIptables.$w$cconvert w) -}
aed9d7cf16fcf8075a1b8a479104e576
  $fToIptablesGenRule :: InstructionsToIptables.ToIptables Types.Rule
  DFunId[0]
  {- Arity: 2,
     Strictness: <S(SLL),1*U(1*U,1*U,A)><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Inline: INLINE (sat-args=0),
     Unfolding: InlineRule (0, False, True)
                InstructionsToIptables.$fToIptablesGenRule_$cconvert
                  `cast`
                (Sym (InstructionsToIptables.NTCo:ToIptables[0] <Types.Rule>_N)) -}
24f79b15bfa9a6b08ced2736127023d0
  $fToIptablesGenRule1 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString# "-j DROP"#) -}
4394153cb64ca93eede1bf3ba7ee2007
  $fToIptablesGenRule2 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString# "-j ACCEPT"#) -}
be4911a58bdac60751a3278a435fa041
  $fToIptablesGenRule3 :: GHC.Base.String
  {- Strictness: b -}
924a524859d5a393d70814e09396788a
  $fToIptablesGenRule4 :: GHC.Base.String
  {- Strictness: b -}
eb964112381d7e72bc071a8599facf61
  $fToIptablesGenRule_$cconvert ::
    Types.Rule -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 2,
     Strictness: <S(SLL),1*U(1*U,1*U,A)><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Inline: INLINE[0],
     Unfolding: InlineRule (2, True, False)
                (\ w :: Types.Rule w1 :: NameIdChain.IdNameChain ->
                 case w of ww { Types.Rule ww1 ww2 ww3 ->
                 InstructionsToIptables.$w$cconvert1 ww1 ww2 w1 }) -}
8ef920e15c6eb6dc4f3ab39b64462388
  $fToIptablesGenRule_$cconvert1 ::
    [Types.Target] -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 2,
     Strictness: <S,1*U><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Unfolding: (\ tx :: [Types.Target] n :: NameIdChain.IdNameChain ->
                 letrec {
                   go5 :: [Types.Target] -> [GHC.Types.Char]
                     {- Arity: 1, Strictness: <S,1*U> -}
                   = \ ds :: [Types.Target] ->
                     case ds of wild {
                       [] -> GHC.Types.[] @ GHC.Types.Char
                       : y ys
                       -> GHC.Base.++
                            @ GHC.Types.Char
                            (InstructionsToIptables.$fToIptablesGenRule_$cconvert2 y n)
                            (go5 ys) }
                 } in
                 go5 tx) -}
06b6d849c08fe2057df8e2042c03360c
  $fToIptablesGenRule_$cconvert2 ::
    Types.Target -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 2,
     Strictness: <S,1*U><L,1*U(A,A,A,1*C1(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Unfolding: (\ ds :: Types.Target n :: NameIdChain.IdNameChain ->
                 case ds of wild {
                   DEFAULT -> InstructionsToIptables.$fToIptablesGenRule4
                   Types.Go i ds1
                   -> case ds1 of wild1 { GHC.Types.I# ds2 ->
                      case ds2 of ds3 {
                        DEFAULT -> InstructionsToIptables.$fToIptablesGenRule4
                        0
                        -> case n of wild2 { NameIdChain.INC ds4 ds5 ds6 ds7 ds8 ds9 ds10 ds11 ds12 ds13 ds14 ds15 ds16 ds17 ds18 ds19 ds20 ds21 ds22 ds23 ds24 ds25 ds26 ->
                           case ds7 i of wild3 {
                             GHC.Base.Nothing -> InstructionsToIptables.$fToIptablesGenRule3
                             GHC.Base.Just ipv
                             -> GHC.CString.unpackAppendCString# "-j "# ipv } } } }
                   Types.ACCEPT -> InstructionsToIptables.$fToIptablesGenRule2
                   Types.DROP -> InstructionsToIptables.$fToIptablesGenRule1 }) -}
aed9d7cf16fcf8075a1b8a479104e576
  $fToIptablesTarget ::
    InstructionsToIptables.ToIptables Types.Target
  DFunId[0]
  {- Arity: 2,
     Strictness: <S,1*U><L,1*U(A,A,A,1*C1(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Inline: INLINE (sat-args=0),
     Unfolding: InlineRule (0, False, True)
                InstructionsToIptables.$fToIptablesGenRule_$cconvert2
                  `cast`
                (Sym (InstructionsToIptables.NTCo:ToIptables[0]
                          <Types.Target>_N)) -}
aed9d7cf16fcf8075a1b8a479104e576
  $fToIptables[] :: InstructionsToIptables.ToIptables [Types.Target]
  DFunId[0]
  {- Arity: 2,
     Strictness: <S,1*U><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Inline: INLINE (sat-args=0),
     Unfolding: InlineRule (0, False, True)
                InstructionsToIptables.$fToIptablesGenRule_$cconvert1
                  `cast`
                (Sym (InstructionsToIptables.NTCo:ToIptables[0]
                          <[Types.Target]>_N)) -}
aed9d7cf16fcf8075a1b8a479104e576
  $fToIptables[]0 ::
    InstructionsToIptables.ToIptables [Types.Criteria]
  DFunId[0]
  {- Arity: 2, Strictness: <S,1*U><L,A>, Inline: INLINE (sat-args=0),
     Unfolding: InlineRule (0, False, True)
                InstructionsToIptables.$fToIptables[]0_$cconvert
                  `cast`
                (Sym (InstructionsToIptables.NTCo:ToIptables[0]
                          <[Types.Criteria]>_N)) -}
c8fcce844a81479176890a62f139c78f
  $fToIptables[]0_$cconvert ::
    [Types.Criteria] -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 2, Strictness: <S,1*U><L,A>, Inline: INLINE[0],
     Unfolding: InlineRule (2, True, True)
                (\ w :: [Types.Criteria] w1 :: NameIdChain.IdNameChain ->
                 InstructionsToIptables.$w$cconvert2 w) -}
270435745e2fa4649869f6f3729c48a9
  $s$fFoldableMap_$celem1 ::
    Types.Criteria
    -> Data.Map.Base.Map k Types.Criteria -> GHC.Types.Bool
  {- Arity: 2, HasNoCafRefs, Strictness: <S,1*U><S,1*U> -}
d4d1a6552d6a0da9fc54701654edf39d
  $w$cconvert :: IptablesTypes.Command -> GHC.Base.String
  {- Arity: 1, Strictness: <S,1*U>, Inline: [0],
     Unfolding: (\ w :: IptablesTypes.Command ->
                 case w of wild {
                   DEFAULT -> InstructionsToIptables.$fToIptablesCommand1
                   IptablesTypes.Append s -> GHC.CString.unpackAppendCString# "-A "# s
                   IptablesTypes.Insert s i
                   -> GHC.CString.unpackAppendCString#
                        "-I "#
                        (GHC.Base.++
                           @ GHC.Types.Char
                           s
                           (GHC.CString.unpackAppendCString#
                              " "#
                              (case i of ww2 { GHC.Types.I# ww3 ->
                               case GHC.Show.$wshowSignedInt
                                      0
                                      ww3
                                      (GHC.Types.[] @ GHC.Types.Char) of ww4 { (#,#) ww5 ww6 ->
                               GHC.Types.: @ GHC.Types.Char ww5 ww6 } }))) }) -}
5433d2f7c90df3baf31b7a2850f51423
  $w$cconvert1 ::
    [Types.Criteria]
    -> [Types.Target] -> NameIdChain.IdNameChain -> GHC.Base.String
  {- Arity: 3,
     Strictness: <S,1*U><L,1*U><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)>,
     Inline: [0],
     Unfolding: (\ ww :: [Types.Criteria]
                   ww1 :: [Types.Target]
                   w :: NameIdChain.IdNameChain ->
                 GHC.Base.++
                   @ GHC.Types.Char
                   (InstructionsToIptables.$w$cconvert2 ww)
                   (InstructionsToIptables.$fToIptablesGenRule_$cconvert1 ww1 w)) -}
886e270b173350bef0c5325897cdc8c2
  $w$cconvert2 :: [Types.Criteria] -> GHC.Base.String
  {- Arity: 1, Strictness: <S,1*U>, Inline: [0] -}
aed9d7cf16fcf8075a1b8a479104e576
  class ToIptables a where
    convert :: a -> NameIdChain.IdNameChain -> GHC.Base.String
da61da82b6e0b1d31a2ead5b36625f6e
  addToIptables ::
    [(Types.Rule, GHC.Base.String, GHC.Types.Int)]
    -> NameIdChain.IdNameChain -> GHC.Base.String -> GHC.Base.String
  {- Arity: 3,
     Strictness: <S,1*U><L,U(A,A,A,C(U),A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A)><L,U> -}
28c8db8d0a1eec03acf16d641ab460a2
  commentOutRules ::
    [(GHC.Base.String, GHC.Types.Int)]
    -> GHC.Base.String -> GHC.Base.String
  {- Arity: 2, Strictness: <S,1*U><S,1*U> -}
instance InstructionsToIptables.ToIptables [IptablesTypes.Command]
  = InstructionsToIptables.$fToIptablesCommand
instance InstructionsToIptables.ToIptables [Types.GenRule]
  = InstructionsToIptables.$fToIptablesGenRule
instance InstructionsToIptables.ToIptables [Types.Target]
  = InstructionsToIptables.$fToIptablesTarget
instance InstructionsToIptables.ToIptables [[]]
  = InstructionsToIptables.$fToIptables[]
instance InstructionsToIptables.ToIptables [[]]
  = InstructionsToIptables.$fToIptables[]0
vectorised variables:
vectorised tycons:
vectorised reused tycons:
parallel variables:
parallel tycons:
trusted: none
require own pkg trusted: False

