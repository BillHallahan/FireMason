(set-option :produce-models true)

(declare-fun reaches(Int Int) Bool)
(declare-fun matches-criteria(Int Int) Bool)
(define-fun matches-rule((r Int) (c Int)) Bool
   (ite (and (matches-criteria r c) (reaches r c)) true false))
(declare-fun ACCEPT () Bool)
(declare-fun DROP () Bool)
(declare-fun protocol () Int)
(assert (<= 0 protocol))
(assert (<= protocol 255))
(declare-fun destination_port () Int)
(assert (<= 0 destination_port))
(assert (<= destination_port 65535))
(declare-fun source_port () Int)
(assert (<= 0 source_port))
(assert (<= source_port 65535))
(assert (=> (reaches 0 0) (reaches 3 0)))


(assert (= (= protocol 22) (matches-criteria 3 0)))
(assert (=> (and (matches-criteria 3 0) (reaches 3 0)) (and DROP (not (reaches 3 1)))))
(assert (=> (and (not (matches-criteria 3 0)) (reaches 3 0)) (reaches 3 1)))
(assert (=> (not (reaches 3 0)) (not (reaches 3 1))))
(assert (= (and (= protocol 6)(= destination_port 5)) (matches-criteria 3 1)))
(assert (=> (reaches 3 1) (reaches 3 2)))
(assert (=> (not (reaches 3 1)) (not (reaches 3 2))))
(assert (= (and (= protocol 6)(= destination_port 5)) (matches-criteria 3 2)))
(assert (=> (and (matches-criteria 3 2) (reaches 3 2)) (and DROP (not (reaches 3 3)))))
(assert (=> (and (not (matches-criteria 3 2)) (reaches 3 2)) (reaches 3 3)))
(assert (=> (not (reaches 3 2)) (not (reaches 3 3))))
(assert (= (and (= protocol 6)(and (<= 902 destination_port ) (<= destination_port 8999))) (matches-criteria 3 3)))
(assert (=> (and (matches-criteria 3 3) (reaches 3 3)) (and DROP (not (reaches 3 4)))))
(assert (=> (and (not (matches-criteria 3 3)) (reaches 3 3)) (reaches 3 4)))
(assert (=> (not (reaches 3 3)) (not (reaches 3 4))))
(assert (= (and (= protocol 6)(= source_port 4)) (matches-criteria 3 4)))
(assert (=> (and (matches-criteria 3 4) (reaches 3 4)) (and DROP (not (reaches 3 5)))))
(assert (=> (and (not (matches-criteria 3 4)) (reaches 3 4)) (reaches 3 5)))
(assert (=> (not (reaches 3 4)) (not (reaches 3 5))))
(assert (= (and (= protocol 17)(= source_port 100)) (matches-criteria 3 5)))
(assert (=> (and (matches-criteria 3 5) (reaches 3 5)) (and DROP (not (reaches 3 6)))))
(assert (=> (and (not (matches-criteria 3 5)) (reaches 3 5)) (reaches 3 6)))
(assert (=> (not (reaches 3 5)) (not (reaches 3 6))))
(assert (= (and (= protocol 6)(and (= source_port 4)(= destination_port 5))) (matches-criteria 3 6)))
(assert (=> (and (matches-criteria 3 6) (reaches 3 6)) (and DROP (not (reaches 3 7)))))
(assert (=> (and (not (matches-criteria 3 6)) (reaches 3 6)) (reaches 3 7)))
(assert (=> (not (reaches 3 6)) (not (reaches 3 7))))

(assert (matches-rule 3 6))

(check-sat)
(get-model)